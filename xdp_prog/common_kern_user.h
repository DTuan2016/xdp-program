#ifndef __COMMON_KERN_USER_H
#define __COMMON_KERN_USER_H

#include <stdint.h>
#include <linux/types.h>

#define TRAINING_SET         10000
#define MAX_FLOW_SAVED       2000

#define QS_NUM_TREES 100
#define MAX_FEATURES 6 
#define QS_NUM_NODES 1500
#define QS_NUM_LEAVES 1600

#define QS_FEATURE_FLOW_DURATION 0
#define QS_FEATURE_TOTAL_FWD_PACKET 1
#define QS_FEATURE_TOTAL_LENGTH_OF_FWD_PACKET 2
#define QS_FEATURE_FWD_PACKET_LENGTH_MAX 3
#define QS_FEATURE_FWD_PACKET_LENGTH_MIN 4
#define QS_FEATURE_FWD_IAT_MIN 5

#define FIXED_SHIFT 8
#define FIXED_SCALE (1ULL << FIXED_SHIFT)
typedef __u64 fixed;

typedef __u16 BITVECTOR_TYPE;

static __always_inline int msb_index(BITVECTOR_TYPE x) {
    return __builtin_clzll((__u64)x) - 48;
}


struct flow_key {
    __u32   src_ip;
    __u16   src_port;
    __u32   dst_ip;
    __u16   dst_port;
    __u8    proto;
} __attribute__((packed));

typedef struct {
    __u64   start_ts;             /* Timestamp of first packet */
    __u64   last_seen;            /* Timestamp of last packet */
    __u64   min_IAT;              /* Minimum Inter-Arrival Time */
    __u32   total_pkts;           /* Total packet count*/
    __u32   max_pkt_len;          /* Maximum packet length */
    __u32   min_pkt_len;          /* Minimum packet length */
    __u32   total_bytes;          /* Total byte count*/

    int   label;
} data_point; 

/*
 Layout rules:
 - Internal nodes are grouped by feature id in ascending order.
 - For feature f, its nodes occupy range [QS_OFFSETS_f, QS_OFFSETS_f+1) in the thresholds array.
 - bitvectors mark (LSB=leaf0) the set of leaves in that tree reachable from the node.
 - leaves array is laid out as [tree0 | tree1 | ...], each block is num_leaves[h] entries with h the tree id.
   If a tree has fewer leaves, the remainder of its block is zero-padded.
 - Each leaves entry is a uint8 class id (argmax at the leaf).
*/
struct feat_vec {
    fixed features[MAX_FEATURES];
};

struct qsDataStruct{
    fixed threshold[QS_NUM_NODES];
    BITVECTOR_TYPE bitvectors[QS_NUM_NODES];
    BITVECTOR_TYPE v[QS_NUM_TREES];
    __u16 tree_ids[QS_NUM_NODES];
    __u8  num_leaves_per_tree[QS_NUM_TREES];
    __u8  leaves[QS_NUM_LEAVES];
};

static const fixed _qs_threshold[QS_NUM_NODES] = {
  384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 896000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1408000, 1408000, 1408000, 1408000, 1408000, 1408000, 3840000, 4736000, 4736000, 5760000, 5760000, 5760000, 5760000, 5888000, 5888000, 7296000, 7296000, 9216000, 9344000, 9472000, 9728000, 10624000, 13184000, 13696000, 13952000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14464000, 14720000, 14720000, 14720000, 14720000, 14720000, 14720000, 14720000, 14720000, 15744000, 16000000, 17408000, 20864000, 24960000, 24960000, 31872000, 32128000, 32128000, 32896000, 35968000, 141184000, 141184000, 145280000, 146048000, 148608000, 148608000, 151168000, 500480000, 1761408000, 3909120000, 3915520000, 5198464000, 5358464000, 7829248000, 7973248000, 7973248000, 7985024000, 10545408000, 10655488000, 10760320000, 11243520000, 11416832000, 11533056000, 11533056000, 14189056000, 14197632000, 14934144000, 15668352000, 16263040000, 16363008000, 16770304000, 17047680000, 17074304000, 17074304000, 17074304000, 17074304000, 17074304000, 17074304000, 17074304000, 17112704000, 17198080000, 17198080000, 17240320000, 17382912000, 17409920000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17664256000, 17674368000, 17700736000, 17727360000, 17727360000, 17727360000, 17729280000, 17790336000, 17913984000, 18317312000, 18317312000, 18317312000, 18560640000, 21300992000, 23174528000, 23731200000, 23765760000, 23783680000, 24009472000, 26659712000, 27915520000, 27915520000, 27915520000, 27920384000, 27921280000, 27924352000, 28139776000, 28596864000, 28718976000, 29556480000, 30385408000, 31002624000, 31452416000, 31857536000, 32153856000, 32153856000, 33355521024, 34978560000, 35048065024, 35167873024, 50459392000, 53192577024, 53314942976, 53332992000, 53590142976, 53596033024, 61367552000, 62760448000, 63297918976, 68763262976, 69733376000, 81240322048, 82794237952, 82794237952, 83963392000, 83963392000, 84200448000, 92567937024, 98857472000, 127413506048, 127415296000, 127422078976, 150918529024, 153287163904, 153491709952, 153509756928, 153509756928, 153620226048, 153690365952, 153690365952, 153690365952, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153709690880, 153750011904, 153750011904, 153750011904, 153755516928, 153755516928, 153755516928, 153755516928, 153755516928, 153755516928, 153755516928, 153755516928, 153755516928, 153824772096, 153842819072, 153942147072, 154023428096, 154042753024, 154042753024, 154042753024, 154042753024, 154042753024, 154083074048, 154083074048, 154088579072, 154211975168, 154328580096, 154346627072, 154346627072, 154346627072, 154527236096, 154534789120, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154546561024, 154592387072, 155093114880, 155348738048, 156054904832, 156054904832, 156810878976, 157240057856, 157700612096, 157962878976, 158126080000, 158417920000, 158598529024, 158617853952, 158617853952, 158617853952, 159344508928, 159568510976, 162240643072, 162415230976, 199300096000, 199300096000, 199545733120, 199545733120, 199545733120, 199750402048, 199750402048, 199750402048, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199808000000, 199861501952, 199928193024, 199928193024, 199985790976, 199985790976, 199985790976, 201007996928, 204418048000, 204418048000, 204418048000, 460352241664, 460620021760, 460620021760, 461019635712, 461527539712, 659297763328, 681872228352, 682514022400, 682776289280, 696525938688, 723914481664, 843906039808, 844487057408, 844487057408, 844487057408, 844487057408, 844502392832, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844722700288, 844738035712, 844738035712, 844766347264, 844774408192, 845095567360, 846784782336, 846784782336, 846784782336, 846784782336, 846784782336, 846828429312, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 896, 896, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1152, 1408, 1408, 1408, 1408, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1664, 1792, 1920, 1920, 1920, 2176, 2176, 2176, 2176, 2176, 2176, 2176, 2176, 2176, 2304, 2304, 2432, 2432, 2432, 2432, 2432, 2432, 2432, 2432, 2432, 2432, 2432, 2944, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3200, 3712, 3712, 3712, 3840, 5248, 15360, 15360, 38272, 108544, 108544, 108544, 108544, 108544, 108544, 108544, 108544, 1280, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5376, 6016, 6016, 6016, 6400, 6400, 6400, 6912, 6912, 6912, 6912, 6912, 6912, 6912, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 7808, 8832, 11520, 11520, 11520, 12032, 12032, 12032, 12032, 12032, 12032, 12544, 12544, 12544, 12544, 12544, 12544, 12544, 12544, 12544, 12544, 16640, 22400, 22400, 26496, 26880, 34560, 34560, 34560, 36096, 36096, 36096, 36096, 36096, 36096, 36096, 36096, 36352, 36352, 36352, 37120, 37120, 37120, 41216, 41728, 42496, 42496, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 42752, 43520, 43776, 43776, 43776, 43776, 47872, 47872, 49664, 50432, 60160, 71168, 91392, 91392, 91392, 98176, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 98560, 100224, 105728, 108032, 161536, 164352, 205568, 205568, 206080, 206080, 224768, 224768, 225024, 225024, 233216, 233216, 233216, 233472, 235008, 339968, 340992, 342400, 343680, 344320, 344320, 344320, 344320, 344320, 355840, 392960, 438528, 453376, 464384, 594432, 594432, 602880, 604160, 608256, 608256, 608256, 608512, 666368, 666368, 702464, 804864, 857088, 967936, 967936, 967936, 979968, 1235712, 2252288, 2963200, 4548096, 9339392, 14152960, 16475904, 384, 384, 384, 384, 384, 384, 640, 640, 896, 2048, 2048, 2048, 2048, 2048, 2048, 4096, 4096, 4096, 4096, 4992, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5248, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5760, 5760, 6016, 6016, 6656, 7040, 7040, 7040, 7040, 7040, 7040, 7040, 11392, 11520, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12032, 12160, 12160, 12160, 12160, 12160, 12160, 12160, 12544, 12544, 12544, 12544, 12544, 13056, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13184, 13440, 13440, 13440, 14592, 15744, 16896, 16896, 16896, 17024, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 21376, 24704, 24704, 24704, 24704, 24704, 24704, 25216, 25472, 26112, 26112, 26112, 29056, 29312, 29952, 33024, 48384, 48384, 48384, 48384, 54784, 55040, 79616, 81792, 107392, 112384, 112512, 112512, 112512, 112512, 121728, 122880, 123008, 123008, 130816, 130944, 130944, 130944, 131328, 131328, 132224, 132224, 132224, 132224, 132224, 132224, 132224, 132224, 132224, 132224, 132736, 132736, 132736, 154240, 189312, 189312, 217728, 217984, 221056, 221056, 221056, 221056, 263936, 272896, 278912, 279936, 376960, 376960, 377728, 377728, 1920, 1920, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2048, 2944, 3968, 3968, 4096, 4096, 4224, 4864, 4864, 4864, 4864, 4864, 4864, 4864, 4864, 4992, 5120, 5120, 5120, 5120, 5120, 5120, 5248, 5248, 5248, 5248, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 5504, 6016, 8448, 8704, 10112, 10112, 10112, 10112, 10112, 10112, 10240, 10624, 10624, 10880, 10880, 10880, 10880, 10880, 10880, 10880, 10880, 10880, 10880, 11776, 11776, 11776, 11776, 12288, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13056, 13440, 13440, 13440, 13440, 14976, 17024, 17024, 17024, 17024, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 17280, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 18048, 20096, 21376, 25472, 29312, 29312, 30464, 33152, 33152, 33664, 37504, 39552, 39552, 39552, 39552, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 384000, 640000, 640000, 640000, 896000, 896000, 896000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1152000, 1280000, 2176000, 2176000, 3968000, 5760000, 5888000, 5888000, 5888000, 5888000, 6144000, 6144000, 6144000, 6272000, 6272000, 6528000, 6528000, 6528000, 6656000, 6656000, 6656000, 6656000, 6656000, 6656000, 6784000, 6784000, 6912000, 6912000, 6912000, 6912000, 7040000, 8320000
};

static const BITVECTOR_TYPE _qs_bitvectors[QS_NUM_NODES] = {
  0xff00, 0xe000, 0xfff0, 0x6000, 0x6000, 0xfff0, 0xfffc, 0xff00, 0xfe00, 0xffc0, 0xffc0, 0xffc0, 0x1800, 0xffc0, 0xffe0, 0xffff, 0xe000, 0xffff, 0xfc00, 0xffe0, 0x0e00, 0xfff8, 0xfff0, 0xfff8, 0xf000, 0x7000, 0xfff8, 0xfe00, 0xfffe, 0xfc00, 0x1f00, 0xfe00, 0x1800, 0xfff0, 0x3fc0, 0xfff8, 0x3fe0, 0xfffc, 0xffff, 0xffc0, 0xffe0, 0xff80, 0xe000, 0xf800, 0xffff, 0xfffc, 0xfff0, 0x3000, 0xfffe, 0xfe00, 0xfffc, 0xfff0, 0xfff8, 0xfff8, 0xfffe, 0xc000, 0xfffc, 0xf800, 0xffff, 0x7800, 0x1c00, 0xfff8, 0xff80, 0xffff, 0x3800, 0x7000, 0x3000, 0xc000, 0xc000, 0xe000, 0x0c00, 0xc000, 0xe000, 0x3800, 0x3000, 0xc000, 0x3800, 0xe000, 0x0c00, 0x7000, 0xe000, 0xe000, 0xe000, 0x6000, 0x3800, 0xc000, 0xc000, 0x0c00, 0x1c00, 0xe000, 0xe000, 0x3000, 0x0c00, 0x3800, 0x6000, 0x1800, 0x3c00, 0xc000, 0xf800, 0x3800, 0xe000, 0x0300, 0xe000, 0xf000, 0x1800, 0x00c0, 0x1800, 0x00c0, 0x0180, 0xe000, 0x0600, 0x1800, 0x1800, 0x7800, 0x0c00, 0x3800, 0x0600, 0x0c00, 0xe000, 0x0300, 0x00c0, 0x3800, 0x1800, 0xc000, 0x0180, 0xc000, 0x0700, 0x0300, 0x00fe, 0x0180, 0x03f0, 0x0600, 0x3f00, 0x3ff8, 0x3000, 0x3000, 0xe000, 0xc000, 0x1800, 0xc000, 0x001c, 0x6000, 0x3000, 0x6000, 0x1800, 0x6000, 0x0380, 0x0600, 0xe000, 0x0180, 0x3e00, 0x7e00, 0xff00, 0xfc00, 0xf000, 0x3e00, 0xffe0, 0xff00, 0x7800, 0xfe00, 0xf800, 0xf800, 0x3000, 0xf800, 0xf000, 0x7e00, 0x3e00, 0x0f00, 0xfc00, 0xfc00, 0x1fc0, 0xe000, 0x00c0, 0x0ff8, 0x03f8, 0x1ff0, 0x0070, 0x03f0, 0x1800, 0x3000, 0x6000, 0x3000, 0x3800, 0x00fe, 0x01c0, 0x0030, 0x0070, 0x00c0, 0x0070, 0x0070, 0x0300, 0x0180, 0x01e0, 0x00c0, 0x0180, 0x0180, 0x0600, 0x007c, 0x0030, 0x0018, 0x000e, 0x0180, 0x0070, 0x0180, 0x0038, 0x0003, 0x0007, 0x6000, 0x0c00, 0x0300, 0x0600, 0x001e, 0x001e, 0x003e, 0x1800, 0x1800, 0x1800, 0x3000, 0x1800, 0x6000, 0x6000, 0x1800, 0x7c00, 0x01fe, 0x00fe, 0x3c00, 0x0300, 0x6000, 0x1800, 0x3fe0, 0x1c00, 0x3fc0, 0x6000, 0x1800, 0x6000, 0x6000, 0x1c00, 0x1800, 0x1800, 0x6000, 0x7f00, 0x6000, 0x3ff0, 0x1c00, 0x1800, 0x6000, 0x6000, 0x7000, 0x01c0, 0x6000, 0x3000, 0x3000, 0x3800, 0x3fc0, 0x0700, 0x1800, 0x03c0, 0x6000, 0x3800, 0x00fe, 0x1800, 0x00c0, 0x7f80, 0x6000, 0x6000, 0x0700, 0x0070, 0x0380, 0x0380, 0x1e00, 0x1e00, 0x0700, 0x0380, 0x003c, 0x00fc, 0x0e00, 0x0018, 0x0030, 0x3000, 0x0060, 0x0180, 0x0180, 0x0180, 0x0180, 0x00e0, 0x0e00, 0x0700, 0x0070, 0x3ff0, 0x007e, 0x1ff8, 0x0070, 0x0c00, 0x3ff0, 0x01c0, 0x01e0, 0x00c0, 0x0030, 0x0c00, 0x1c00, 0x000e, 0x000c, 0x0030, 0x000c, 0x0038, 0x0078, 0x6000, 0x3000, 0x0c00, 0x001c, 0x01c0, 0x003e, 0x001c, 0x0060, 0x0038, 0x01ff, 0x000e, 0x003f, 0x01f8, 0x003f, 0x01f0, 0x00c0, 0xffff, 0x001f, 0x003f, 0x0078, 0x01fc, 0x03e0, 0x00ff, 0x001f, 0x003f, 0xffff, 0xffff, 0x03f8, 0x3fff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0070, 0x001c, 0x01e0, 0x0003, 0x003c, 0x000e, 0x0038, 0x007c, 0xffff, 0xffff, 0xffff, 0xffff, 0x0030, 0x00c0, 0x01c0, 0x00c0, 0x03e0, 0x007c, 0x00c0, 0x0700, 0x000e, 0x0038, 0x0060, 0x003f, 0x0060, 0x000f, 0x003c, 0x0006, 0x001f, 0xffff, 0x0007, 0x0030, 0x003c, 0x000c, 0x0300, 0x0180, 0x00c0, 0x0c00, 0x0060, 0x1f80, 0x00e0, 0x00c0, 0x00e0, 0x0078, 0x0300, 0x0060, 0x000c, 0x0380, 0x07c0, 0x0f00, 0x0600, 0x3c00, 0x3c00, 0x3c00, 0x1f00, 0x1c00, 0x3000, 0x7800, 0x00c0, 0x1e00, 0x1e00, 0x1f00, 0x0c00, 0x07e0, 0x1e00, 0x1c00, 0x0c00, 0x0600, 0x3000, 0x0e00, 0x1800, 0x3800, 0x0300, 0x0600, 0x1800, 0x1800, 0x0e00, 0x3c00, 0x0600, 0x1800, 0x1c00, 0x0018, 0x0180, 0x3000, 0x0300, 0x0700, 0x0180, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x000f, 0x0006, 0x000c, 0x000f, 0x0003, 0x0003, 0x000f, 0x0003, 0x000f, 0x0003, 0x0003, 0x0007, 0x0018, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0030, 0x000f, 0x0007, 0x003e, 0x0003, 0x0003, 0x0007, 0x000c, 0x3fc0, 0xe000, 0xf800, 0x1e00, 0x7f00, 0xffff, 0x0e00, 0x0700, 0xfe00, 0x1f00, 0x0380, 0x0780, 0xc000, 0x3800, 0x0018, 0xe000, 0xff80, 0x3c00, 0x0006, 0x7000, 0x3000, 0x0006, 0x7e00, 0x3f00, 0x3000, 0xff00, 0xff00, 0xffff, 0xf000, 0x0060, 0xf800, 0xfe00, 0x6000, 0x3f00, 0xffff, 0x3f00, 0xfffe, 0x3000, 0x1f00, 0xf800, 0xff00, 0x000c, 0xff00, 0x0006, 0x3fe0, 0x01c0, 0x7e00, 0x1800, 0xf800, 0x3e00, 0x0006, 0x3c00, 0xc000, 0xfc00, 0x3c00, 0xf000, 0x000c, 0x7800, 0xf800, 0xfc00, 0xf800, 0xffff, 0x1c00, 0x00e0, 0x00fc, 0x01f8, 0x3800, 0x0180, 0xf000, 0xf800, 0x03c0, 0x0600, 0x1800, 0xc000, 0x1f00, 0x0e00, 0x0c00, 0xe000, 0x0030, 0xe000, 0x0018, 0x1800, 0x00c0, 0x01e0, 0x0ff0, 0x0700, 0x0300, 0x0180, 0x00f8, 0xe000, 0xf000, 0x0180, 0x03c0, 0x1fc0, 0x0f00, 0x0030, 0x1e00, 0x0700, 0x03c0, 0x0fe0, 0x01c0, 0x1f80, 0x0380, 0x0300, 0x0700, 0x0300, 0x1c00, 0x03c0, 0x0c00, 0x3f00, 0x1800, 0x01c0, 0x03e0, 0x0380, 0x0070, 0x0700, 0x7800, 0xfff0, 0x1f00, 0x0600, 0x01c0, 0x0c00, 0x0c00, 0x01fe, 0x00ff, 0x001f, 0x003e, 0x003f, 0x001f, 0x00f0, 0x0078, 0x0070, 0x001f, 0x001e, 0x0006, 0x0060, 0x003c, 0x00e0, 0x007c, 0x0030, 0x01ff, 0x0e00, 0x003c, 0x0600, 0x0030, 0x0030, 0x0060, 0x0780, 0x0e00, 0x0078, 0x0078, 0x01f0, 0x01f8, 0x01f8, 0x01c0, 0x0078, 0x01c0, 0x0006, 0x0018, 0x0003, 0x0003, 0x01e0, 0x0003, 0x0003, 0x0006, 0x0003, 0x0030, 0x0006, 0x0003, 0x0006, 0x00e0, 0x0038, 0x000c, 0x00f0, 0x0030, 0x003c, 0x00f8, 0x000f, 0x01e0, 0x00f0, 0x001e, 0x0030, 0x007c, 0x03e0, 0x01e0, 0x00f8, 0x03f0, 0x0ff8, 0x0030, 0x007c, 0x00f0, 0x007c, 0x0038, 0x0030, 0x03f0, 0x0006, 0x0030, 0x001c, 0x03c0, 0x0078, 0x00f0, 0x01f8, 0x000c, 0x0006, 0x0078, 0x01f0, 0x0f80, 0x003c, 0x0018, 0x0018, 0x000e, 0x0300, 0x0030, 0x0fff, 0x0003, 0x0300, 0x0007, 0x0003, 0x0007, 0x0003, 0x0003, 0x003f, 0xc000, 0xc000, 0xc000, 0xc000, 0x3000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xe000, 0xc000, 0xc000, 0x0300, 0xc000, 0xc000, 0xc000, 0x3000, 0x0380, 0x3000, 0x0e00, 0x0300, 0xf000, 0x3f80, 0x0600, 0x1f00, 0x3800, 0xffc0, 0xfe00, 0xfffc, 0x0c00, 0xfff8, 0xff80, 0xff80, 0xfff0, 0xfffe, 0xff80, 0x1800, 0xff80, 0xfffc, 0x3e00, 0x00e0, 0x07c0, 0xfff0, 0xff00, 0xff00, 0xffc0, 0xfff0, 0xffc0, 0xfff0, 0x3fc0, 0x3f80, 0x3e00, 0x3800, 0x3ff8, 0x1fe0, 0x3ff0, 0x3ffc, 0x3ff8, 0x1e00, 0x0600, 0x0600, 0x0180, 0x03c0, 0x0c00, 0x03e0, 0x0030, 0x03c0, 0x0180, 0x000c, 0x000c, 0x000c, 0x000c, 0x0006, 0x000c, 0x000c, 0xffe0, 0xf800, 0xffc0, 0x0700, 0x0f00, 0x07c0, 0x01f0, 0x0600, 0x0fe0, 0x01e0, 0x01c0, 0x000e, 0x000e, 0x0007, 0x00ff, 0x0007, 0x000f, 0x0007, 0x000e, 0x000e, 0x000e, 0x000e, 0x0007, 0x0018, 0x000e, 0x003e, 0x000c, 0x01fc, 0x01f8, 0x0f00, 0x0700, 0x07fc, 0x003c, 0x0007, 0x0300, 0xe000, 0x00e0, 0xf000, 0x0038, 0x0060, 0x0078, 0x1e00, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xfffe, 0xffff, 0x3fff, 0x3ffe, 0xffff, 0xffff, 0xffff, 0xffff, 0x0ffe, 0xffff, 0xffff, 0xfffe, 0xffff, 0x00c0, 0x0038, 0x0300, 0x03e0, 0x0060, 0x03ff, 0x000e, 0x007f, 0x00ff, 0x0018, 0x0060, 0x0018, 0x00e0, 0x001c, 0x0078, 0x0030, 0x01c0, 0x000c, 0x0600, 0x03f0, 0x00f0, 0x01f0, 0x03e0, 0x3fc0, 0x000e, 0x000e, 0x03f0, 0x0070, 0x001c, 0x0030, 0x000c, 0x00e0, 0x007e, 0x007c, 0x07f0, 0x1fe0, 0x007e, 0x03e0, 0x03f0, 0x0070, 0x0380, 0x03f8, 0x000c, 0x0018, 0x000c, 0x000c, 0x0030, 0x001c, 0x0180, 0x0078, 0x000f, 0x0006, 0x000e, 0x003f, 0x001e, 0x0003, 0x6000, 0x7f00, 0xf000, 0x3e00, 0x1e00, 0x0c00, 0xf800, 0x3c00, 0x0600, 0x1c00, 0x01c0, 0x6000, 0x01c0, 0x0030, 0x3800, 0xc000, 0xc000, 0xc000, 0xc000, 0x3000, 0xc000, 0xc000, 0xc000, 0xe000, 0xc000, 0x3fe0, 0x3000, 0xc000, 0xc000, 0x3f00, 0x7ff0, 0xfff0, 0x7ffc, 0xfffe, 0xfff8, 0xfff8, 0xff00, 0x3fc0, 0xff80, 0xff00, 0x3ff8, 0xffe0, 0xfe00, 0xfff0, 0xfff0, 0xfffc, 0x3ffe, 0xff80, 0x3ff8, 0xfff8, 0xff80, 0xff80, 0x3fe0, 0x0fc0, 0x3ffc, 0x1fe0, 0xfff0, 0x3f80, 0x3f00, 0xfc00, 0x00c0, 0x1ff8, 0x00c0, 0x3e00, 0x7ff8, 0x3ff0, 0x3ff8, 0xffc0, 0xfff0, 0xfff0, 0xff00, 0xff00, 0x3e00, 0x0ff0, 0xfe00, 0x3c00, 0x7000, 0xfc00, 0x0700, 0x0780, 0x3800, 0x0e00, 0xfff8, 0x3c00, 0xff80, 0x1c00, 0xc000, 0xc000, 0x0180, 0x03f0, 0x01c0, 0x0600, 0x0180, 0x00c0, 0x0060, 0x00e0, 0x0300, 0x0c00, 0x0180, 0x03e0, 0x007c, 0x0180, 0x0600, 0x0078, 0x0700, 0x0180, 0x0600, 0x00c0, 0x1e00, 0x01c0, 0x00c0, 0x0c00, 0x00c0, 0x0e00, 0x1c00, 0x01f0, 0x0078, 0x03f8, 0x01c0, 0x0c00, 0x0380, 0x0f00, 0x0f80, 0x01f0, 0x07f0, 0x0180, 0x00e0, 0x07f0, 0x00fe, 0x03f0, 0x03f0, 0x01f0, 0x07f0, 0x03c0, 0x03fc, 0x07e0, 0x0700, 0x0780, 0x0600, 0x0060, 0x01c0, 0x0300, 0x03c0, 0x0070, 0x0300, 0x0060, 0x0300, 0xffff, 0x0fc0, 0x0030, 0x3fc0, 0x01c0, 0x0c00, 0xffff, 0x000c, 0xffff, 0x07ff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0038, 0x03e0, 0xffff, 0x7800, 0xffff, 0x1e00, 0x1fff, 0xffff, 0xffff, 0x00e0, 0xffff, 0x0070, 0x0018, 0xffff, 0x0038, 0xffff, 0x0600, 0x1f80, 0x0018, 0x000c, 0x000c, 0x000c, 0x0780, 0x3000, 0x000c, 0x0060, 0x0038, 0x0030, 0x001c, 0x000f, 0xfffe, 0xffff, 0x0180, 0x000f, 0xffff, 0x0003, 0x0e00, 0x0003, 0x0007, 0xffff, 0x000e, 0x0600, 0x0006, 0x001f, 0x0007, 0xffff, 0xfffe, 0x0007, 0x000f, 0x00c0, 0x0060, 0x0006, 0xfffe, 0x0006, 0x000e, 0xffff, 0xffff, 0x003e, 0x00c0, 0x0007, 0x000e, 0xffff, 0xffff, 0x000e, 0x000e, 0xffff, 0x0007, 0xffff, 0x000f, 0x0007, 0x0006, 0x000e, 0xfffe, 0x0007, 0x000f, 0x000e, 0xffff, 0x0003, 0x0007, 0x3fff, 0x0007, 0x01c0, 0x03f0, 0x003e, 0x003e, 0x01f8, 0x03e0, 0xe000, 0xf000, 0x00f0, 0x00e0, 0x0380, 0xe000, 0xe000, 0x01e0, 0x00c0, 0x003c, 0x003c, 0x003c, 0x007c, 0x0018, 0x0060, 0x01f8, 0x0006, 0x0038, 0x0018, 0x0060, 0x0030, 0x001c, 0x001c, 0x001e, 0x003c, 0x000e, 0x000e, 0x001e, 0x003f, 0x007f, 0x007f, 0x001e, 0x00fe, 0x1fc0, 0x0038, 0x003f, 0x003f, 0x007f, 0x007f, 0x007c, 0x01ff, 0x003f, 0x007f, 0x0007, 0x001c, 0x000e, 0x0fc0, 0x01c0, 0x0c00, 0x00c0, 0x0030, 0x01c0, 0x00c0, 0x0060, 0x0180, 0x01c0, 0x00f0, 0x0038, 0x00e0, 0x003e, 0x00fe, 0x007e, 0x003e, 0x1fe0, 0x00e0, 0x001c, 0x007f, 0x0060, 0x0018, 0x007c, 0x000c, 0x000c, 0x01f0, 0x3c00, 0x0060, 0x00c0, 0xc000, 0xc000, 0xc000, 0x03f0, 0x00f8, 0xfe00, 0xfff0, 0xffe0, 0x0ffc, 0x0380, 0x0600, 0x3000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xc000, 0xfff0, 0x3ff0, 0x00fc, 0x03f8, 0xfc00, 0xfff0, 0x01f8, 0x3ff8, 0xffc0, 0xfffc, 0x0fc0, 0x01fc, 0xfff0, 0xfff0, 0x3ffc, 0xffc0, 0x0fe0, 0x01f8, 0x03f8, 0x07f0, 0xfff8, 0x0018, 0x0700, 0x0180, 0x0018, 0x0018, 0x007f, 0x0060, 0x0018, 0x001e, 0x0060, 0x0300, 0x00c0, 0x00ff, 0x03ff, 0x001e, 0x000e, 0x000f, 0x003f, 0x001e, 0x007f, 0x03ff, 0x003c, 0x00ff, 0x00ff, 0x03ff, 0x01ff, 0x001f, 0x003f, 0x000f, 0x001f, 0x00e0, 0x000f, 0x01c0, 0x007e, 0x007f, 0x003c, 0x007f, 0x000f, 0x007f, 0x001e, 0x0078, 0x01f0, 0x00c0, 0x0300, 0x01f0, 0x0030, 0xffff, 0xffff, 0xfffe, 0x00e0, 0xffff, 0xffff, 0xfffe, 0xffff, 0xffff, 0xffff, 0x0f80, 0xffff, 0x0fff, 0xffff, 0xffff, 0xffff, 0xffff, 0xfffe, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x3ffe, 0xffff, 0xffff, 0xffff, 0x0f80, 0x07c0, 0xffff, 0xffff, 0xffff, 0x0030, 0xfffe, 0xffff, 0x1fff, 0xfffe, 0x001c, 0x0780, 0xffff, 0xffff, 0xffff, 0xffff, 0x0ffe, 0x03c0, 0xffff, 0xffff, 0x1fff, 0xffff, 0x0780, 0xffff, 0xffff, 0xffff, 0x0ffc, 0x000c, 0x0006, 0x0380, 0x000c, 0x000c, 0x000c, 0x000c, 0x0180, 0x000c, 0x000c, 0x3f00, 0x3800, 0xf000, 0xf000, 0xe000, 0x01e0, 0x001f, 0x000f, 0x0003, 0x000f, 0x000c, 0x0007, 0x000f, 0x0003, 0x7000, 0x7e00, 0xfc00, 0x3e00, 0x3000, 0xfc00, 0x1800, 0xf000, 0xffe0, 0xf800, 0x0006, 0x3e00, 0xf000, 0xf000, 0xfc00, 0x0f00, 0x7e00, 0xff80, 0x1800, 0x0300, 0xfc00, 0x07c0, 0x3c00, 0x3800, 0x1c00, 0x3000, 0x0180, 0x7e00, 0x3c00, 0xfc00, 0x1800, 0x3800, 0xf800, 0x3f00, 0x0c00, 0x0f00, 0x7000, 0x0e00, 0x1e00, 0x00f0, 0x3fff, 0x000c, 0x3800, 0xe000, 0x00f0, 0x3800, 0x6000, 0x000c, 0x7800, 0x7000, 0x1e00, 0x3f80, 0x3800, 0xc000, 0x0ff0, 0x007c, 0x1e00, 0x001c, 0x0f80, 0x000c, 0x1c00, 0x01c0, 0xe000, 0x007c, 0x6000, 0x000e, 0x1f00, 0x3800, 0x001e, 0x1fc0, 0x1e00, 0x000c, 0x01e0, 0x1f80, 0x0f00, 0x0ff8, 0x3c00, 0xe000, 0xfe00, 0x07f0, 0x00c0, 0xc000, 0x3000, 0x07c0, 0x00f0, 0x03f0, 0x000e, 0x03f0, 0x0c00, 0x0300, 0x0c00, 0x3000, 0x3e00, 0x6000, 0x1800, 0x0e00, 0x0f00, 0x1c00, 0x0300, 0x0180, 0x1800, 0x3800, 0x0c00, 0x1c00, 0x0700, 0x0e00, 0x03f0, 0x00c0, 0x3800, 0x0600, 0x6000, 0x1800, 0x3fc0, 0xff80, 0x00e0, 0x0ffc, 0x3c00, 0x3ff0, 0xfff8, 0x3ff8, 0x1ff8, 0x3fe0, 0x0fe0, 0x3f00, 0x3fc0, 0x7ffc, 0xff00, 0x3000, 0x3f80
};

static const __u16 _qs_tree_ids[QS_NUM_NODES] = {
  0, 2, 3, 4, 5, 6, 8, 9, 10, 12, 13, 14, 16, 17, 19, 20, 22, 23, 24, 26, 27, 29, 33, 34, 35, 36, 39, 40, 41, 42, 44, 47, 49, 54, 55, 56, 57, 58, 59, 63, 64, 65, 66, 68, 70, 72, 74, 75, 76, 77, 78, 79, 80, 81, 82, 85, 86, 87, 88, 91, 94, 97, 98, 99, 3, 8, 10, 11, 15, 16, 17, 21, 27, 33, 36, 37, 41, 44, 45, 47, 48, 49, 50, 52, 54, 55, 57, 57, 59, 60, 62, 65, 69, 72, 78, 79, 80, 83, 85, 86, 89, 89, 94, 95, 97, 12, 15, 17, 21, 32, 32, 34, 37, 40, 50, 56, 56, 62, 69, 76, 80, 81, 83, 84, 98, 30, 35, 38, 41, 73, 99, 3, 14, 39, 17, 26, 45, 61, 21, 75, 13, 66, 12, 6, 29, 22, 82, 54, 53, 60, 0, 9, 18, 22, 38, 58, 66, 67, 68, 73, 84, 90, 91, 92, 1, 6, 12, 14, 51, 52, 64, 71, 57, 20, 70, 88, 49, 51, 80, 40, 95, 85, 74, 9, 79, 1, 75, 28, 93, 21, 14, 20, 81, 29, 66, 94, 7, 5, 28, 23, 11, 61, 43, 33, 53, 14, 90, 49, 59, 83, 75, 57, 55, 73, 18, 3, 6, 8, 33, 44, 45, 72, 51, 31, 95, 24, 90, 92, 9, 19, 22, 26, 32, 41, 48, 50, 52, 54, 56, 60, 67, 73, 74, 80, 81, 89, 94, 95, 47, 62, 47, 68, 85, 14, 39, 66, 20, 27, 40, 4, 86, 10, 43, 16, 69, 95, 97, 49, 52, 96, 4, 5, 63, 17, 87, 31, 22, 91, 87, 54, 51, 50, 58, 40, 81, 77, 28, 48, 33, 4, 46, 32, 53, 7, 94, 29, 91, 5, 82, 71, 95, 76, 77, 73, 92, 46, 28, 11, 48, 14, 61, 92, 12, 90, 52, 31, 69, 73, 15, 17, 29, 30, 36, 45, 55, 77, 86, 94, 96, 64, 85, 95, 4, 20, 46, 49, 66, 71, 82, 87, 91, 35, 44, 79, 72, 1, 26, 65, 75, 76, 33, 57, 47, 50, 22, 25, 39, 84, 8, 27, 2, 3, 5, 6, 13, 18, 32, 53, 54, 67, 7, 74, 32, 40, 63, 28, 88, 14, 24, 81, 34, 99, 0, 16, 21, 39, 60, 98, 24, 3, 44, 6, 15, 21, 37, 45, 83, 1, 5, 19, 29, 50, 69, 70, 72, 73, 79, 96, 9, 31, 17, 51, 75, 5, 12, 60, 92, 62, 10, 41, 63, 78, 24, 32, 93, 8, 54, 64, 58, 1, 48, 77, 89, 22, 15, 25, 30, 35, 37, 40, 42, 51, 56, 60, 75, 79, 81, 90, 94, 97, 2, 21, 88, 16, 61, 6, 50, 68, 78, 86, 29, 2, 3, 4, 5, 6, 8, 11, 12, 14, 16, 18, 20, 23, 23, 26, 30, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 44, 45, 46, 48, 49, 49, 50, 51, 54, 55, 56, 57, 58, 59, 60, 62, 66, 69, 70, 72, 73, 73, 74, 75, 80, 80, 81, 82, 85, 86, 89, 91, 92, 93, 94, 95, 96, 98, 6, 8, 10, 10, 15, 20, 23, 25, 27, 32, 34, 34, 45, 47, 64, 71, 76, 78, 78, 84, 86, 89, 90, 92, 93, 97, 98, 99, 7, 74, 2, 8, 10, 16, 18, 22, 27, 29, 32, 48, 49, 56, 57, 61, 64, 65, 67, 71, 72, 81, 88, 88, 91, 93, 94, 97, 16, 27, 30, 61, 4, 5, 11, 13, 23, 26, 28, 52, 58, 59, 73, 74, 82, 83, 86, 87, 93, 96, 96, 98, 93, 52, 58, 86, 43, 46, 48, 50, 51, 58, 70, 78, 93, 7, 61, 8, 12, 24, 33, 35, 44, 52, 90, 92, 96, 98, 11, 0, 1, 3, 6, 7, 9, 10, 11, 15, 16, 19, 20, 21, 25, 27, 28, 38, 39, 40, 41, 42, 43, 47, 51, 60, 62, 65, 67, 68, 75, 80, 86, 87, 95, 97, 99, 2, 5, 70, 46, 59, 42, 74, 99, 0, 11, 23, 27, 30, 43, 53, 68, 7, 12, 39, 42, 55, 72, 74, 76, 77, 79, 82, 87, 99, 97, 14, 33, 86, 13, 23, 35, 0, 18, 53, 54, 58, 67, 90, 1, 4, 18, 20, 22, 36, 43, 51, 69, 75, 88, 90, 93, 19, 11, 23, 37, 5, 35, 47, 49, 83, 84, 12, 13, 26, 42, 56, 64, 80, 86, 97, 98, 91, 43, 82, 94, 4, 60, 69, 84, 1, 27, 32, 37, 38, 65, 71, 79, 2, 25, 62, 34, 57, 72, 58, 2, 30, 99, 1, 6, 7, 10, 11, 15, 27, 28, 32, 33, 37, 38, 65, 68, 71, 85, 99, 40, 50, 53, 55, 93, 68, 77, 67, 99, 76, 27, 9, 56, 65, 7, 1, 3, 12, 13, 14, 19, 26, 43, 44, 47, 53, 55, 57, 62, 72, 73, 75, 76, 83, 90, 95, 98, 70, 41, 35, 33, 97, 24, 85, 45, 92, 9, 38, 41, 42, 19, 43, 47, 31, 55, 66, 84, 56, 79, 22, 34, 61, 62, 81, 77, 76, 87, 17, 96, 9, 93, 89, 2, 5, 30, 94, 18, 71, 82, 83, 53, 45, 19, 21, 31, 25, 24, 59, 85, 73, 92, 31, 99, 2, 9, 30, 65, 78, 99, 38, 63, 40, 51, 64, 71, 74, 88, 93, 19, 29, 63, 81, 39, 3, 13, 17, 23, 26, 33, 57, 64, 65, 0, 6, 7, 8, 9, 10, 15, 16, 17, 21, 28, 29, 30, 31, 32, 38, 40, 41, 45, 46, 50, 52, 53, 54, 55, 58, 59, 60, 63, 65, 68, 69, 70, 74, 77, 78, 79, 81, 85, 89, 91, 92, 95, 96, 99, 37, 74, 25, 49, 67, 3, 11, 44, 48, 61, 71, 73, 96, 46, 3, 20, 22, 44, 46, 47, 48, 56, 71, 73, 78, 82, 9, 26, 31, 41, 43, 63, 77, 62, 66, 70, 72, 76, 99, 1, 4, 6, 8, 15, 17, 19, 21, 35, 36, 37, 38, 52, 59, 60, 69, 74, 79, 80, 84, 85, 86, 89, 92, 93, 1, 59, 85, 34, 30, 50, 55, 76, 36, 0, 1, 3, 7, 12, 13, 16, 18, 21, 23, 25, 28, 31, 32, 34, 38, 42, 43, 45, 46, 59, 64, 65, 67, 68, 71, 72, 77, 78, 85, 95, 98, 0, 7, 16, 33, 36, 43, 60, 67, 68, 85, 0, 2, 4, 5, 13, 16, 17, 18, 19, 20, 22, 24, 25, 26, 29, 30, 34, 35, 36, 39, 42, 44, 45, 46, 49, 50, 51, 52, 54, 55, 55, 56, 60, 61, 63, 64, 66, 67, 70, 74, 79, 80, 81, 84, 87, 88, 89, 91, 92, 93, 94, 96, 97, 30, 42, 63, 69, 77, 89, 59, 82, 37, 38, 68, 20, 70, 60, 79, 12, 14, 44, 98, 34, 96, 46, 23, 46, 4, 35, 75, 83, 98, 95, 87, 55, 57, 13, 44, 52, 98, 4, 96, 7, 8, 12, 14, 24, 35, 36, 61, 83, 90, 24, 36, 96, 2, 33, 46, 31, 37, 15, 16, 42, 68, 66, 39, 40, 80, 17, 87, 36, 47, 66, 89, 4, 5, 24, 31, 35, 57, 59, 61, 11, 43, 95, 56, 59, 98, 49, 56, 61, 66, 67, 82, 83, 87, 14, 20, 54, 70, 80, 88, 97, 0, 24, 41, 58, 2, 3, 18, 22, 25, 27, 29, 34, 44, 48, 57, 58, 62, 71, 72, 73, 76, 78, 81, 91, 94, 67, 36, 85, 12, 14, 21, 36, 44, 67, 4, 24, 92, 28, 42, 45, 49, 54, 63, 64, 65, 68, 92, 0, 16, 25, 77, 23, 1, 3, 19, 19, 26, 26, 41, 43, 47, 53, 62, 75, 76, 90, 15, 37, 84, 86, 17, 15, 37, 91, 95, 2, 6, 7, 8, 9, 10, 13, 18, 20, 22, 27, 29, 30, 33, 34, 38, 39, 40, 41, 46, 48, 50, 51, 53, 55, 56, 58, 60, 62, 66, 69, 70, 71, 72, 75, 78, 79, 80, 81, 82, 83, 84, 86, 88, 89, 90, 93, 94, 97, 99, 6, 10, 13, 25, 42, 51, 64, 75, 84, 89, 11, 43, 76, 23, 88, 31, 0, 38, 8, 84, 36, 52, 61, 83, 1, 10, 15, 17, 19, 21, 22, 25, 27, 28, 28, 29, 31, 36, 37, 39, 47, 48, 52, 53, 61, 64, 65, 68, 70, 77, 77, 78, 79, 83, 84, 87, 91, 97, 0, 2, 5, 7, 9, 10, 11, 13, 15, 18, 18, 21, 25, 26, 28, 31, 32, 34, 37, 38, 39, 40, 45, 45, 48, 49, 50, 51, 52, 53, 53, 54, 62, 63, 63, 66, 69, 69, 70, 71, 76, 82, 83, 84, 87, 88, 89, 90, 90, 91, 96, 25, 63, 88, 8, 23, 98, 0, 10, 18, 28, 47, 62, 97, 59, 48, 67, 91, 94, 29, 41, 69, 82, 11, 58, 72, 9, 64, 13, 35, 39, 20, 42, 54, 74, 80, 88, 26, 57, 19, 63, 78, 87, 24, 65
};

static const __u8 _qs_num_leaves_per_tree[QS_NUM_TREES] = {
  16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16
};

static const __u8 _qs_leaves[QS_NUM_LEAVES] = {
  /* tree 0 */ 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0,
  /* tree 1 */ 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0,
  /* tree 2 */ 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0,
  /* tree 3 */ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1,
  /* tree 4 */ 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0,
  /* tree 5 */ 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1,
  /* tree 6 */ 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0,
  /* tree 7 */ 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0,
  /* tree 8 */ 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1,
  /* tree 9 */ 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1,
  /* tree 10 */ 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1,
  /* tree 11 */ 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0,
  /* tree 12 */ 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0,
  /* tree 13 */ 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0,
  /* tree 14 */ 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0,
  /* tree 15 */ 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0,
  /* tree 16 */ 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,
  /* tree 17 */ 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0,
  /* tree 18 */ 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1,
  /* tree 19 */ 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1,
  /* tree 20 */ 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1,
  /* tree 21 */ 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0,
  /* tree 22 */ 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,
  /* tree 23 */ 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0,
  /* tree 24 */ 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0,
  /* tree 25 */ 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0,
  /* tree 26 */ 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1,
  /* tree 27 */ 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,
  /* tree 28 */ 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1,
  /* tree 29 */ 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0,
  /* tree 30 */ 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0,
  /* tree 31 */ 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0,
  /* tree 32 */ 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0,
  /* tree 33 */ 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0,
  /* tree 34 */ 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1,
  /* tree 35 */ 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
  /* tree 36 */ 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0,
  /* tree 37 */ 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0,
  /* tree 38 */ 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1,
  /* tree 39 */ 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1,
  /* tree 40 */ 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0,
  /* tree 41 */ 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1,
  /* tree 42 */ 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0,
  /* tree 43 */ 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0,
  /* tree 44 */ 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0,
  /* tree 45 */ 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0,
  /* tree 46 */ 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0,
  /* tree 47 */ 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0,
  /* tree 48 */ 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0,
  /* tree 49 */ 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0,
  /* tree 50 */ 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0,
  /* tree 51 */ 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0,
  /* tree 52 */ 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1,
  /* tree 53 */ 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0,
  /* tree 54 */ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1,
  /* tree 55 */ 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0,
  /* tree 56 */ 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0,
  /* tree 57 */ 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0,
  /* tree 58 */ 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0,
  /* tree 59 */ 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
  /* tree 60 */ 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0,
  /* tree 61 */ 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1,
  /* tree 62 */ 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
  /* tree 63 */ 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1,
  /* tree 64 */ 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0,
  /* tree 65 */ 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1,
  /* tree 66 */ 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0,
  /* tree 67 */ 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0,
  /* tree 68 */ 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0,
  /* tree 69 */ 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1,
  /* tree 70 */ 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1,
  /* tree 71 */ 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0,
  /* tree 72 */ 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0,
  /* tree 73 */ 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0,
  /* tree 74 */ 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0,
  /* tree 75 */ 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0,
  /* tree 76 */ 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0,
  /* tree 77 */ 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0,
  /* tree 78 */ 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0,
  /* tree 79 */ 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0,
  /* tree 80 */ 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1,
  /* tree 81 */ 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0,
  /* tree 82 */ 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0,
  /* tree 83 */ 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1,
  /* tree 84 */ 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1,
  /* tree 85 */ 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0,
  /* tree 86 */ 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0,
  /* tree 87 */ 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0,
  /* tree 88 */ 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0,
  /* tree 89 */ 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0,
  /* tree 90 */ 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0,
  /* tree 91 */ 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0,
  /* tree 92 */ 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1,
  /* tree 93 */ 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1,
  /* tree 94 */ 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0,
  /* tree 95 */ 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0,
  /* tree 96 */ 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0,
  /* tree 97 */ 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0,
  /* tree 98 */ 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0,
  /* tree 99 */ 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1,
};


#define QS_OFFSETS_0 0
#define QS_OFFSETS_1 461
#define QS_OFFSETS_2 684
#define QS_OFFSETS_3 880
#define QS_OFFSETS_4 1191
#define QS_OFFSETS_5 1371
#define QS_OFFSETS_6 1500

#define QS_FEATURE(IDX, START, END) do {                              \
    fixed feat_value = fv.features[IDX];                             \
    _Pragma("unroll")                                                \
    for (int i = (START); i < (END); i++) {                          \
        if (feat_value < tree->threshold[i]) {                       \
            __u16 h = tree->tree_ids[i];                             \
            if (h >= QS_NUM_TREES) return 0;                         \
            tree->v[h] ^= tree->bitvectors[i];                       \
        } else break;                                                \
    }                                                                \
} while (0)


#ifndef XDP_ACTION_MAX
#define XDP_ACTION_MAX (XDP_REDIRECT + 1)
#endif

static __always_inline fixed fixed_from_uint(__u64 value)
{
    return value << FIXED_SHIFT;
}

static __always_inline __u64 fixed_to_uint(fixed value)
{
    return value >> FIXED_SHIFT;
} 

#endif /* __COMMON_KERN_USER_H */